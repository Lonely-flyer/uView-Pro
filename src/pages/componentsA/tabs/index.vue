<template>
	<view class="u-demo">
		<view class="u-demo-wrap">
			<view class="u-demo-title">演示效果</view>
			<view class="u-demo-area">
				<u-toast ref="uToast"></u-toast>
				<u-tabs v-if="control" bg-color="#fafafa" :bold="bold" :active-color="activeColor" :list="list"
				@change="change" :current="current" :is-scroll="isScroll" :offset="offset"></u-tabs>
			</view>
		</view>
		<view class="u-config-wrap">
			<view class="u-config-title u-border-bottom">
				参数配置
			</view>
			<view class="u-config-item">
				<view class="u-item-title">模式选择</view>
				<u-subsection :current="sectionCurrent" :list="['滚动', '非滚动']" @change="modeChange"></u-subsection>
			</view>
			<view class="u-config-item">
				<view class="u-item-title">标签个数(非滚动模式)</view>
				<u-subsection :list="['2', '3',  '4']" @change="countChange"></u-subsection>
			</view>
			<view class="u-config-item">
				<view class="u-item-title">活动选项字颜色</view>
				<u-subsection mode="button" :list="['primary', 'success', 'error', 'warning']" @change="colorChange"></u-subsection>
			</view>
			<view class="u-config-item">
				<view class="u-item-title">字体加粗</view>
				<u-subsection mode="button" :list="['是', '否']" @change="boldChange"></u-subsection>
			</view>
		</view>
	</view>
</template>

<script setup lang="ts">
import { onLoad } from '@dcloudio/uni-app';
import { ref, nextTick } from 'vue';
import { $u } from '@/uni_modules/uview-pro';

interface TabItem {
	name: string;
	count?: number;
}

const list = ref<TabItem[]>([]);
const data: TabItem[] = [{
	name: '关注',
	count: 100
}, {
	name: '推荐',
	count: 7
}, {
	name: '电影'
},{
	name: '电视剧'
},{
	name: '小视频'
}, {
	name: '游戏'
}, {
	name: '校园'
},{
	name: '影视'
},{
	name: '音乐'
}];

const current = ref(0);
const sectionCurrent = ref(0);
const isScroll = ref(true);
const tabCountIndex = ref(0);
const activeColor = ref($u.color['primary']);
const bold = ref(true);
const control = ref(true);
const offset = ref<[number, number]>([5, -5]);
const uToast = ref(null);

function countChange(index: number) {
	sectionCurrent.value = 1;
	if(index == 0) {
		list.value = [];
		list.value.push(data[0]);
		list.value.push(data[1]);
		offset.value = [5, 60];
	} else if(index == 1) {
		list.value = [];
		list.value.push(data[0]);
		list.value.push(data[1]);
		list.value.push(data[2]);
		offset.value = [5, 20];
	} else {
		list.value = [];
		list.value.push(data[0]);
		list.value.push(data[1]);
		list.value.push(data[2]);
		list.value.push(data[3]);
		offset.value = [5, 5];
	}
	tabCountIndex.value = index;
	isScroll.value = false;
}

function change(index: number) {
	current.value = index;
}

function modeChange(index: number) {
	control.value = false;
	current.value = 0;
	if(index == 0) {
		isScroll.value = true;
		list.value = data;
		offset.value = [5, -5];
	} else {
		isScroll.value = false;
		countChange(tabCountIndex.value);
	}
	nextTick(() => {
		control.value = true;
	});
}

function colorChange(e: number) {
	let color = 'primary';
	switch(e) {
		case 0:
			color = 'primary';break;
		case 1:
			color = 'success';break;
		case 2:
			color = 'error';break;
		case 3:
			color = 'warning';break;
	}
	activeColor.value = $u.color[color];
}

function boldChange(e: number) {
	switch(e) {
		case 0:
			bold.value = true;break;
		case 1:
			bold.value = false;break;
	}
}

onLoad(() => {
	list.value = data;
});
</script>

<style lang="scss" scoped>
	.u-config-wrap {

	}
</style>
